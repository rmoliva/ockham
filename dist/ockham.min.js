/*! ockham.js - v0.0.1+build.1434809699303 - 2015-06-24 : minified */
!function(a,b){b["true"]=a,function(){var b={error:function(a){return{name:"OckhamError",level:"Show Stopper",message:a,htmlMessage:a,toString:function(){return this.name+": "+this.message}}},state:function(a,b,c){var d=[],e=function(){var a=[];return c&&a.push(c.getCompleteName()),a.push(b),a.join("-")},f=function(a,b){d[a]=b},g=function(a){return _.isUndefined(d[a])?c?c.can(a):!1:!0},h=function(b,f,g){var h,i=d[f];return d[f]?h=_.isFunction(i)?i(b,g):new Promise(function(a,b){a(d[f],g)}):c&&(h=c.doTransition(b,f,g)),h?h:Promise.reject(new a.error("No transition '"+f+"' in state: '"+e()+"'"))};return{getCompleteName:e,addTransition:f,can:g,doTransition:h}},fsm:function(a){var b=null,c={},d=[],e=function(a,b,d,f){var g;g=new a.state(a,b,f),c[g.getCompleteName()]=g,_.each(d,function(b,c){"states"===c?_.each(b,function(b,c){e(a,c,b,g)},this):g.addTransition(c,b)},this)},f=function(a){return b?b.can(a):!1},g=function(a){return!f(a)},h=function(){return b.getCompleteName()},i=function(a){return b?b.getCompleteName()===a:!1},j=function(a,d){var e,f,g=this;return b.doTransition(g,a,d).then(function(g){return e=b.getCompleteName(),b=c[g],f={from:e,to:b.getCompleteName(),transition:a,options:d}}).then(function(a){return l(a)})},k=function(a,b){d.push({transition:a,options:b})},l=function(a){var b,c;return _.isEmpty(d)?Promise.resolve(a):(b=_.first(d),c=j(b.transition,b.options),d.splice(0,1),c)},m=_.extend({can:f,cannot:g,is:i,doTransition:j,deferTransition:k,processTransitionQueue:l,currentName:h},a.config(this));return _.each(m.states,function(a,b){e(this,b,a,null)},this),b=c.none,m},create:function(a){var b=this.fsm(a);return b}};"undefined"!=typeof a?("undefined"!=typeof module&&module.exports&&(a=module.exports=b),a.Ockham=b):"function"==typeof define&&define.amd?define(function(a){return b}):"undefined"!=typeof window?window.Ockham=b:"undefined"!=typeof self&&(self.Ockham=b)}()}({},function(){return this}());